
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8.2. Data Acquisition &#8212; Phenotype from Genotype</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.3. Data Wrangling" href="3-data-wrangling.html" />
    <link rel="prev" title="8.1. Introduction" href="1-background.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/thesis_logo_with_text.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Phenotype from Genotype</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Front Matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c0-front-matter/01-title-page.html">
   <code class="docutils literal notranslate">
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c0-front-matter/02-declaration.html">
   Declaration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c0-front-matter/03-abstract.html">
   Abstract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c0-front-matter/04-acknowledgements.html">
   Acknowledgements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c0-front-matter/05-full-table-of-contents.html">
   Table of Contents
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Background
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c01-introduction/intro.html">
   1. Thesis style and philosophy
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../c02-biology-background/0-index.html">
   2. How phenotype arises from genotype
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../c02-biology-background/1-big-questions.html">
     2.1. Big questions: What is genetically determined, and how?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c02-biology-background/2-biological-molecules.html">
     2.2. Biological molecules: DNA, RNA, Proteins and the central dogma of molecular biology.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c02-biology-background/3-more-dna.html">
     2.3. A closer look at DNA: Genomes, Genes, and Genetic Variation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c02-biology-background/4-more-proteins.html">
     2.4. Looking more closely at proteins: function, structure and classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c02-biology-background/5-phenotype.html">
     2.5. Phenotype
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c02-biology-background/6-summary.html">
     2.6. Summary: how genotype and phenotype are linked
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../c03-compbio-background/0-index.html">
   3. How genotype and phenotype are measured and researched
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../c03-compbio-background/1-sequencing-technology.html">
     3.1. Sequencing and microarrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c03-compbio-background/2-measuring-genotype-phenotype.html">
     3.2. From genotype to phenotype: what is measured
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c03-compbio-background/3-ontologies.html">
     3.3. Ontologies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c03-compbio-background/4-comp-bio-methods.html">
     3.4. Predictive computational methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c03-compbio-background/5-bias.html">
     3.5. Sources of bias in computational biology
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c03-compbio-background/6-pqi.html">
     3.6. Proteome Quality Index
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c03-compbio-background/7-summary.html">
     3.7. Summary
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Phenotype prediction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../c04-snowflake/0-index.html">
   4. Phenotype prediction with Snowflake
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../c04-snowflake/1-introduction.html">
     4.1. Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c04-snowflake/2-snowflake-algorithm.html">
     4.2.
     <code class="docutils literal notranslate">
      <span class="pre">
       Snowflake
      </span>
     </code>
     Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c04-snowflake/3-creating-inputs.html">
     4.3. Creating Snowflake inputs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c04-snowflake/4-preprocessing.html">
     4.4. Preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c04-snowflake/5-clustering-snps.html">
     4.5. Considerations for Clustering SNPs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c04-snowflake/7-discussion.html">
     4.6. Discussion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../c05-alspac/0-index.html">
   5. Predicting phenotypes of the ALSPAC cohort using Snowflake
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../c05-alspac/1-introduction.html">
     5.1. Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c05-alspac/5-discussion.html">
     5.2. Discussion
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tissue-specific gene expression
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../c06-filter/0-index.html">
   6. Filtering computational predictions with tissue-specific expression information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../c06-filter/1-introduction.html">
     6.1. Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c06-filter/2-algorithm.html">
     6.2. Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c06-filter/3-data.html">
     6.3. Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c06-filter/5-methods.html">
     6.4. Validation method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c06-filter/6-results.html">
     6.5. Filip results
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c06-filter/7-discussion.html">
     6.6. Discussion and Future work
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../c07-ontolopy/0-index.html">
   7. Ontolopy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../c07-ontolopy/1-introduction.html">
     7.1. Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c07-ontolopy/2-functionality.html">
     7.2. Functionality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c07-ontolopy/3-how-it-works.html">
     7.3. Ontolopy tools and practices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c07-ontolopy/4-misc-examples.html">
     7.4. Example uses: mapping samples to diseases or phenotypes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c07-ontolopy/5-mapping-example.html">
     7.5. Example use: mapping samples to tissue-related phenotypes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c07-ontolopy/6-discussion.html">
     7.6. Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../c07-ontolopy/7-future-work.html">
     7.7. Future Work
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="0-index.html">
   8. Combining RNA-seq datasets
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="1-background.html">
     8.1. Introduction
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     8.2. Data Acquisition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-data-wrangling.html">
     8.3. Data Wrangling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="7-discussion.html">
     8.4. Results and discussion
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Concluding remarks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c09-conclusion/0-conclusion.html">
   9. Concluding remarks
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  End Matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../cz-end-matter/0-appendix.html">
   Appendix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cz-end-matter/reference.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#criteria-for-choosing-datasets">
   8.2.1. Criteria for choosing datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gene-expression-vs-protein-abundance">
     8.2.1.1. Gene expression vs protein abundance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gene-expression-vs-transcript-expression">
     8.2.1.2. Gene expression vs Transcript expression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tissue-specificity-versus-cell-specificity">
       8.2.1.2.1. Tissue-specificity versus cell-specificity
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inclusion-of-cage-data">
     8.2.1.3. Inclusion of CAGE data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excluding-disease-focused-experiments">
     8.2.1.4. Excluding disease-focused experiments
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method-of-searching">
   8.2.2. Method of searching
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eligible-data-sets">
   8.2.3. Eligible data sets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fantom5">
     8.2.3.1. FANTOM5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#human-protein-atlas">
     8.2.3.2. Human Protein Atlas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#genotype-tissue-expression">
     8.2.3.3. Genotype Tissue Expression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#human-developmental-biology-resource">
     8.2.3.4. Human Developmental Biology Resource
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combining-data-acquisition">
   8.2.4. Data acquisition
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Data Acquisition</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#criteria-for-choosing-datasets">
   8.2.1. Criteria for choosing datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gene-expression-vs-protein-abundance">
     8.2.1.1. Gene expression vs protein abundance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gene-expression-vs-transcript-expression">
     8.2.1.2. Gene expression vs Transcript expression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tissue-specificity-versus-cell-specificity">
       8.2.1.2.1. Tissue-specificity versus cell-specificity
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inclusion-of-cage-data">
     8.2.1.3. Inclusion of CAGE data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excluding-disease-focused-experiments">
     8.2.1.4. Excluding disease-focused experiments
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method-of-searching">
   8.2.2. Method of searching
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eligible-data-sets">
   8.2.3. Eligible data sets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fantom5">
     8.2.3.1. FANTOM5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#human-protein-atlas">
     8.2.3.2. Human Protein Atlas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#genotype-tissue-expression">
     8.2.3.3. Genotype Tissue Expression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#human-developmental-biology-resource">
     8.2.3.4. Human Developmental Biology Resource
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combining-data-acquisition">
   8.2.4. Data acquisition
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="data-acquisition">
<span id="id1"></span><h1><span class="section-number">8.2. </span>Data Acquisition<a class="headerlink" href="#data-acquisition" title="Permalink to this headline">¶</a></h1>
<p>This section describes the constituent data sets that were chosen for combination, and how they were chosen and acquired.</p>
<div class="section" id="criteria-for-choosing-datasets">
<span id="gxacriteria"></span><h2><span class="section-number">8.2.1. </span>Criteria for choosing datasets<a class="headerlink" href="#criteria-for-choosing-datasets" title="Permalink to this headline">¶</a></h2>
<p>Datasets were chosen from the EBI’s Gene Expression Atlas (GxA)<span id="id2">[<a class="reference internal" href="../cz-end-matter/reference.html#id35"><span>61</span></a>]</span>: the European Bioinformatics Institutes’ Open Source gene and protein expression database, and the largest of its type.
At the time of writing, it contains over 3,000 gene expression and protein abundance experiments across many organisms, organism parts (tissues), diseases, and sequencing technologies.
There is a separate database for scRNA-seq experiments.</p>
<p>A major benefit of the GxA is that raw data using the same sequencing technology is re-analysed by GxA using the same data analysis pipeline (iRAP<span id="id3">[<a class="reference internal" href="../cz-end-matter/reference.html#id89"><span>247</span></a>]</span> for RNA-Seq).
In addition to ensuring the quality of each data set included, and running it through the same pipeline, the GxA adds additional metadata for the experiments by using the literature to biologically and technically annotate each sample.</p>
<p>Data sets were chosen based on the following requirements.</p>
<ol class="simple">
<li><p><strong>Inclusion in the GxA</strong>.</p></li>
<li><p><strong>Experiments must be measuring baseline, rather than differential gene expression</strong>.</p></li>
<li><p><strong>Samples must be sequenced using Next Generation Sequencing</strong>, i.e. including RNA-Seq and CAGE, and excluding microarrays.</p></li>
<li><p><strong>Data sets must contain a breadth of tissues and genes</strong>,  i.e. experiments must include “organism part” as an experimental factor (otherwise tissue would not be recorded) and must have at least 80 assays (samples).</p></li>
<li><p><strong>Samples must not be disease-focused</strong>. In practice, excluding cancer datasets was enough to exclude disease-focused datasets.</p></li>
</ol>
<p>Choices (1)-(3) were made to ensure the data underwent the most similar possible analysis pipeline.
Number (4) was necessary to aid batch correction by facilitating the most balanced data set design in terms of batch (experiment) to group (tissue), and in order to have good coverage of genes and tissues, which is necessary for downstream use.
Choice number (5) was also made primarily to aid batch correction: since many phenotypes occur only in particular tissues, there is not a breadth of tissue measurements for most diseases.</p>
<p>As described in the introduction chapter, there are many ways to measure which proteins are being created.
Here, I justify my choices of measures to include in the combined data set.</p>
<div class="section" id="gene-expression-vs-protein-abundance">
<span id="geprotein"></span><h3><span class="section-number">8.2.1.1. </span>Gene expression vs protein abundance<a class="headerlink" href="#gene-expression-vs-protein-abundance" title="Permalink to this headline">¶</a></h3>
<p>As I <a class="reference internal" href="../c03-compbio-background/2-measuring-genotype-phenotype.html#gene-expression-protein-abundance"><span class="std std-ref">mentioned earlier</span></a>, gene expression is only weakly correlated to protein abundance.
So, what are the potential reasons for this, and which makes a better measure of the process of translation?</p>
<p>One reason is that there is something preventing the mRNA from being translated, such as slow codons, the temperature, ribosome occupancy, or regulatory RNAs and proteins<span id="id4">[<a class="reference internal" href="../cz-end-matter/reference.html#id94"><span>248</span></a>]</span>.
In these cases, the DNA is transcribed into mRNA, but the protein is never produced, meaning that using gene expression data as a measure of how much protein is produced would be overestimating the protein abundance.
If these factors were a large contribution to the weak correlation, it could provide better results to use protein abundance data instead of mRNA abundance data to make predictions about how proteins are affecting human phenotypes.
On the other hand, it could equally be possible that proteins are being produced, but not measured by protein abundance techniques.
Protein half-lives range over orders of magnitude from seconds to days<span id="id5">[<a class="reference internal" href="../cz-end-matter/reference.html#id94"><span>248</span></a>,<a class="reference internal" href="../cz-end-matter/reference.html#id95"><span>249</span></a>]</span>.
In this case, gene expression data may be a more reliable measure of protein production than protein abundance, since proteins may degrade before being measured.
In yeast, protein degradation was shown to be the largest contribution to the protein-mRNA correlation compared to codon and amino acid usage (the two other factors estimated in the study), and more influential than those other two factors combined<span id="id6">[<a class="reference internal" href="../cz-end-matter/reference.html#id96"><span>250</span></a>]</span>.</p>
<p>In summary, there’s no perfect measure of translation, but since gene expression data is more readily available, and protein degradation appears to account for most of the differences between correlations, gene expression data presents the best proxy for translation for the downstream uses discussed here.</p>
</div>
<div class="section" id="gene-expression-vs-transcript-expression">
<span id="genetranscriptexp"></span><h3><span class="section-number">8.2.1.2. </span>Gene expression vs Transcript expression<a class="headerlink" href="#gene-expression-vs-transcript-expression" title="Permalink to this headline">¶</a></h3>
<p>It’s likely that transcript expression data would provide more insight than gene expression data if it were available, since it is likely that there are tissue-specific transcripts which do not correspond to tissue-specific genes, e.g. where different transcripts from the same gene are expressed in different tissues.
Transcript expression data, however, is harder to come by and this approach relies on a wealth of available data.
Furthermore, transcript expression data can be straightforwardly converted to gene expression data (by summing over the transcripts), while the conversion of gene to transcript expression data is decidedly less accurate.
When transcript-expression (CAGE) measurements are aggregated at the gene/protein level, measures of tissue-specificity have been found to largely (75-93%) match up with measures of tissue-specificity resulting from gene-expression measurements, as found in a comparison between the HPA and FANTOM5 experiments<span id="id7">[<a class="reference internal" href="../cz-end-matter/reference.html#id97"><span>251</span></a>]</span>.</p>
<p>For these reasons, I have taken a gene-centric approach here.
It may be important, however, to consider whether a gene has multiple transcripts in downstream analysis, for example, if including tissue-specific gene expression information when predicting the function of a protein-coding SNP (since it may not be in the relevant transcript).</p>
<div class="section" id="tissue-specificity-versus-cell-specificity">
<h4><span class="section-number">8.2.1.2.1. </span>Tissue-specificity versus cell-specificity<a class="headerlink" href="#tissue-specificity-versus-cell-specificity" title="Permalink to this headline">¶</a></h4>
<div class="figure align-default" id="homogenous-tissues">
<a class="reference internal image-reference" href="../_images/tissues_HPA.png"><img alt="../_images/tissues_HPA.png" src="../_images/tissues_HPA.png" style="height: 220px;" /></a>
<p class="caption"><span class="caption-number">Fig. 8.1 </span><span class="caption-text">Images of smooth muscle tissue from the stomach wall (left) and lung tissue (right), examples of homogeneous and heterogeneous tissue types respectively, taken from the Human Tissue Atlas website<span id="id8">[<a class="reference internal" href="../cz-end-matter/reference.html#id156"><span>252</span></a>]</span>.</span><a class="headerlink" href="#homogenous-tissues" title="Permalink to this image">¶</a></p>
</div>
<p>Tissues can be made up of various cell types.
Some tissue types (e.g. smooth muscle) are quite homogeneous, comprising of predominantly one cell type and/or lacking structural features.
Other tissues (e.g. lung) are heterogeneous, consisting of multiple cell types and features.
<a class="reference internal" href="#homogenous-tissues"><span class="std std-numref">Fig. 8.1</span></a> shows the different structure of two example tissue types.
The bronchioles of the lung alone consist of six different cell types (basal cells, neuroendocrine cells, ciliated cells, serous cells, Clara cells and goblet cells), while smooth muscle tissue consists almost exclusively of tightly packed smooth muscle cells.
The varying proportions of constituent cell types in heterogeneous tissues can influence tissue function.</p>
<p>While we may prefer to look at the gene expression of a cell type, we currently have much less scRNA-seq data than bulk RNA-seq data.
Bulk RNA-seq also gives us the ability to measure the gene expression of tissues as they appear in humans.
The average supply of a protein to a tissue (averaged over multiple cell types) may well influence a tissue’s phenotype, in these circumstances gene expression at the level of a tissue may give us information that we can’t retrieve from cell-line cells alone.</p>
</div>
</div>
<div class="section" id="inclusion-of-cage-data">
<span id="includecage"></span><h3><span class="section-number">8.2.1.3. </span>Inclusion of CAGE data<a class="headerlink" href="#inclusion-of-cage-data" title="Permalink to this headline">¶</a></h3>
<p>CAGE is transcript expression, rather than gene expression, and there are likely to be different transcripts measured by CAGE than by RNA-Seq.
As mentioned above, however, it is possible to calculate gene expression from transcript expression.
It’s also possible to map between CAGE transcription start sites and existing transcript IDs that may be featured in RNA-Seq arrays.
When this is done, it has been observed that the results of CAGE are comparable to those of RNA-seq<span id="id9">[<a class="reference internal" href="../cz-end-matter/reference.html#id98"><span>253</span></a>]</span>, so the inclusion of CAGE data in a combined data set is reasonable.</p>
</div>
<div class="section" id="excluding-disease-focused-experiments">
<span id="excludediseasewhy"></span><h3><span class="section-number">8.2.1.4. </span>Excluding disease-focused experiments<a class="headerlink" href="#excluding-disease-focused-experiments" title="Permalink to this headline">¶</a></h3>
<p>The decision to exclude disease-focused experiments was made primarily to reduce the complexity of the analysis and the resulting data set.
The data set can now be interpreted as representing gene expression of healthy tissues.
This was also a practical choice since most disease data sets (with the exception of cancer datasets) tended to have a narrow breadth of tissues, which would interfere with the batch correction methodology.
For example, experiments interested in heart disease would naturally contain measurements of healthy and non-healthy heart tissues, and not other tissues, so would be difficult to combine with existing data sets due to the “missing” data.
This would not have been a problem for cancer experiments, however cancer samples gene expression is known to be tissue-non-specific<span id="id10">[<a class="reference internal" href="../cz-end-matter/reference.html#id40"><span>68</span></a>,<a class="reference internal" href="../cz-end-matter/reference.html#id90"><span>197</span></a>]</span>.</p>
</div>
</div>
<div class="section" id="method-of-searching">
<span id="searchhowgxa"></span><h2><span class="section-number">8.2.2. </span>Method of searching<a class="headerlink" href="#method-of-searching" title="Permalink to this headline">¶</a></h2>
<p>It would have been preferable to interrogate the GxA for datasets using the ExpressionAtlas R package, or the <a class="reference external" href="https://www.ebi.ac.uk/arrayexpress/help/programmatic_access.html">AtlasExpress API</a> which it is built on.
However, it was necessary to do so via the <a class="reference external" href="https://www.ebi.ac.uk/gxa/experiments">website</a> since searches to the AtlasExpress API cannot differentiate between baseline and differential gene expression.</p>
<p>For reproducibility, this was done by downloading <a class="reference external" href="https://www.ebi.ac.uk/gxa/json/experiments">the json file</a> used by the GxA experiment browser webservice and by choosing experiments with:</p>
<ul class="simple">
<li><p>baseline (rather than differential) expression measurements</p></li>
<li><p>homo sapiens species</p></li>
<li><p>RNA-Seq mRNA technology</p></li>
<li><p><em>organism part</em> as an experimental factor</p></li>
<li><p>at least 80 assays.</p></li>
<li><p>no mention of “cancer” in the description</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">libraries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">httr</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">IRdisplay</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">ExpressionAtlas</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">htmlwidgets</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">libraries</span><span class="p">())</span>

<span class="n">analysis_date</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;2019-06-01&quot;</span><span class="w">  </span><span class="c1">#YYYY-mm-dd</span>
<span class="n">min_assays</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">80</span>

<span class="c1"># Get information about experiments</span>
<span class="n">gxa_json</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;https://www.ebi.ac.uk/gxa/json/experiments&#39;</span>
<span class="n">req</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">httr</span><span class="o">::</span><span class="nf">GET</span><span class="p">(</span><span class="n">gxa_json</span><span class="p">)</span>
<span class="n">text</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">httr</span><span class="o">::</span><span class="nf">content</span><span class="p">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>
<span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as_tibble</span><span class="p">(</span><span class="n">jsonlite</span><span class="o">::</span><span class="nf">fromJSON</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">$</span><span class="n">experiments</span><span class="p">)</span>

<span class="c1"># All data at time of analysis:</span>
<span class="n">gxa_experiment_info</span><span class="o">$</span><span class="n">loadDate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.Date</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="o">$</span><span class="n">loadDate</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%d-%m-%Y&quot;</span><span class="p">)</span>
<span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">loadDate</span><span class="o">&lt;</span><span class="n">analysis_date</span><span class="p">)</span>
<span class="n">funnel_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;All experiments&quot;</span><span class="p">,</span>
<span class="w">                      </span><span class="n">num_experiments</span><span class="o">=</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="p">))</span>

<span class="c1"># All next-gen sequencing experiments:</span>
<span class="n">gxa_experiment_info</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">technologyType</span><span class="o">==</span><span class="s">&#39;RNA-Seq mRNA&#39;</span><span class="p">)</span>
<span class="n">funnel_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">funnel_info</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">add_row</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;RNA-Seq technology&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">num_experiments</span><span class="o">=</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="p">))</span>

<span class="c1"># All baseline expression experiments</span>
<span class="n">gxa_experiment_info</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">experimentType</span><span class="o">==</span><span class="s">&#39;Baseline&#39;</span><span class="p">)</span>
<span class="n">baseline</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="p">)</span>
<span class="n">funnel_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">funnel_info</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">add_row</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Baseline experiments&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">num_experiments</span><span class="o">=</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="p">))</span>

<span class="c1"># All human experiments</span>
<span class="n">gxa_experiment_info</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">species</span><span class="o">==</span><span class="s">&#39;Homo sapiens&#39;</span><span class="p">)</span>
<span class="n">funnel_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">funnel_info</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">add_row</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Human&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">num_experiments</span><span class="o">=</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="p">))</span>

<span class="c1"># All &quot;organism part&quot; experiments with &gt; 80 assays:</span>
<span class="n">gxa_experiment_info</span><span class="o">$</span><span class="n">experimentalFactors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="o">$</span><span class="n">experimentalFactors</span><span class="p">)</span>
<span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">numberOfAssays</span><span class="o">&gt;</span><span class="n">min_assays</span><span class="p">,</span><span class="w"> </span>
<span class="w">         </span><span class="nf">str_detect</span><span class="p">(</span><span class="n">experimentalFactors</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;organism part&#39;</span><span class="p">))</span>
<span class="n">funnel_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">funnel_info</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">add_row</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Contains tissues and &gt;80 samples&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">num_experiments</span><span class="o">=</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="p">))</span>

<span class="c1"># Excluding cancer experiments:</span>
<span class="n">gxa_experiment_info</span><span class="o">$</span><span class="n">experimentDescription</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="o">$</span><span class="n">experimentDescription</span><span class="p">)</span>
<span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gxa_experiment_info</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">str_detect</span><span class="p">(</span><span class="n">experimentDescription</span><span class="p">,</span><span class="s">&#39;[cC]ancer&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">negate</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
<span class="n">funnel_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">funnel_info</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">add_row</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Not cancer experiments&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">num_experiments</span><span class="o">=</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gxa_experiment_info</span><span class="p">))</span>


<span class="n">create_fig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(){</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">plot_ly</span><span class="p">()</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fig</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">add_trace</span><span class="p">(</span>
<span class="w">        </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;funnel&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">funnel_info</span><span class="o">$</span><span class="n">name</span><span class="p">),</span>
<span class="w">        </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">funnel_info</span><span class="o">$</span><span class="n">num_experiments</span><span class="p">))</span>
<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fig</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">layout</span><span class="p">(</span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">categoryarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">funnel_info</span><span class="o">$</span><span class="n">name</span><span class="p">)))</span>
<span class="c1">#     orca(fig, &#39;../images/combining_funnel_static.png&#39;, width=800)</span>
<span class="w">     </span><span class="nf">saveWidget</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;../images/combining_funnel_interactive.html&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">selfcontained</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="c1">#     IRdisplay::display_html(file=&#39;../images/combining_funnel_interactive.html&#39;)</span>

<span class="p">}</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">create_fig</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<iframe src="../_static/combining_funnel_interactive.html" height="345px" width="100%", frameBorder="0"></iframe><div class="figure align-default" id="funnel-combine-gxa">
<a class="reference internal image-reference" href="../_images/blank.png"><img alt="../_images/blank.png" src="../_images/blank.png" style="height: 0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 8.2 </span><span class="caption-text">Our requirements for a data set reduce the number of eligible data sets to four.</span><a class="headerlink" href="#funnel-combine-gxa" title="Permalink to this image">¶</a></p>
</div>
<p>As <a class="reference internal" href="#funnel-combine-gxa"><span class="std std-numref">Fig. 8.2</span></a> shows, at the time of writing, there are over 3000 experiments in the GxA, and of these 27 are human baseline RNA-Seq experiments.
Of these there are 4 which offer a good coverage of non-disease organism parts.</p>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="eligible-data-sets">
<span id="gxaelligible"></span><h2><span class="section-number">8.2.3. </span>Eligible data sets<a class="headerlink" href="#eligible-data-sets" title="Permalink to this headline">¶</a></h2>
<p>The four eligible data sets are summarised in <a class="reference internal" href="#table-chosen-combine-gxa"><span class="std std-numref">Table 8.1</span></a>, and they are described in further detail below.</p>
<table class="table" id="table-chosen-combine-gxa">
<caption><span class="caption-number">Table 8.1 </span><span class="caption-text">Table showing the GxA datasets that meet the criteria</span><a class="headerlink" href="#table-chosen-combine-gxa" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">shortName</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">experimentAccession</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">experimentDescription</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">numberOfAssays</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">experimentalFactors</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">HPA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">E-MTAB-2836</span></code></p></td>
<td><p>RNA-seq of coding RNA from tissue samples of 122 human individuals representing 32 different tissues</p></td>
<td><p>200</p></td>
<td><p>organism part</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FANTOM5</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">E-MTAB-3358</span></code></p></td>
<td><p>RNA-Seq CAGE (Cap Analysis of Gene Expression) analysis of human tissues in RIKEN FANTOM5 project</p></td>
<td><p>96</p></td>
<td><p>developmental stage, organism part</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GTEx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">E-MTAB-5214</span></code></p></td>
<td><p>RNA-seq from 53 human tissue samples from the Genotype-Tissue Expression (GTEx) Project</p></td>
<td><p>18736</p></td>
<td><p>organism part</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">HDBR</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">E-MTAB-4840</span></code></p></td>
<td><p>RNA-seq of coding RNA: Human Developmental Biology Resource (HDBR) expression resource of prenatal human brain development</p></td>
<td><p>613</p></td>
<td><p>developmental stage, organism part</p></td>
</tr>
</tbody>
</table>
<div class="section" id="fantom5">
<span id="combiningfantom"></span><h3><span class="section-number">8.2.3.1. </span>FANTOM5<a class="headerlink" href="#fantom5" title="Permalink to this headline">¶</a></h3>
<p>opI used the FANTOM5 data, as described in <a class="reference internal" href="../c06-filter/3-data.html#fantom5-expression-data"><span class="std std-numref">Section 6.3.1</span></a>.</p>
</div>
<div class="section" id="human-protein-atlas">
<span id="combininghpa"></span><h3><span class="section-number">8.2.3.2. </span>Human Protein Atlas<a class="headerlink" href="#human-protein-atlas" title="Permalink to this headline">¶</a></h3>
<p>The Human Protein Atlas (HPA) project<span id="id11">[<a class="reference internal" href="../cz-end-matter/reference.html#id99"><span>254</span></a>,<a class="reference internal" href="../cz-end-matter/reference.html#id100"><span>255</span></a>]</span> aims to map all human proteins in cells (including subcellular locations), tissues and organs. The HPA project’s data is not limited to the gene expression data that can be found in GxA, but that is the only part of the data that is used here. The gene expression data that was used (E-MTAB-2836 in GxA) excludes cell lines and includes tissue samples of 122 individuals and 32 different non-diseased tissue types.</p>
</div>
<div class="section" id="genotype-tissue-expression">
<span id="combininggtex"></span><h3><span class="section-number">8.2.3.3. </span>Genotype Tissue Expression<a class="headerlink" href="#genotype-tissue-expression" title="Permalink to this headline">¶</a></h3>
<p>The Genotype Tissue Expression (GTEx) project<span id="id12">[<a class="reference internal" href="../cz-end-matter/reference.html#id101"><span>256</span></a>]</span> was developed specifically for the purpose of studying tissue-specific gene expression in humans and gene expression data from over 18,000 samples, including 53 non-diseased tissue types and 550 individuals (ranging in age from 20s to 70s).</p>
</div>
<div class="section" id="human-developmental-biology-resource">
<span id="combininghdbr"></span><h3><span class="section-number">8.2.3.4. </span>Human Developmental Biology Resource<a class="headerlink" href="#human-developmental-biology-resource" title="Permalink to this headline">¶</a></h3>
<p>The Human Developmental Biology Resource (HDBR) Expression data<span id="id13">[<a class="reference internal" href="../cz-end-matter/reference.html#id102"><span>257</span></a>]</span> is slightly different from the other data sets in that contains a much narrower range of sample types. All HDBR samples are human brain samples at different stages of development, ranging from 3 to 20 weeks after conception.</p>
</div>
</div>
<div class="section" id="combining-data-acquisition">
<span id="id14"></span><h2><span class="section-number">8.2.4. </span>Data acquisition<a class="headerlink" href="#combining-data-acquisition" title="Permalink to this headline">¶</a></h2>
<p>Data was obtained, where possible via the <em>ExpressionAtlas</em> R package<span id="id15">[<a class="reference internal" href="../cz-end-matter/reference.html#id157"><span>258</span></a>]</span>, which gives gene expression counts identified by ENSG IDs, metadata (containing pipeline, filtering, mapping and quantification information), and details of experimental design (containing for example organism part name, individual demographics, and replicate information, depending on the experiment).</p>
<p>For the FANTOM experiment, counts for transcript expression were downloaded directly <a class="reference external" href="http://fantom.gsc.riken.jp/5/datafiles/reprocessed/hg38_latest/extra/CAGE_peaks_expression/hg38_fair+new_CAGE_peaks_phase1and2_counts_ann.osc.txt.gz">from the FANTOM website</a>.<br />
The downloaded FANTOM5 file has already undergone some quality control by FANTOM, it is limited to peaks which meet a “robust” threshold (&gt;10 read counts and 1TPM for at least one sample).
The data acquisition code is not executed in this notebook as it is slow to download all the files, but the <code class="docutils literal notranslate"><span class="pre">R</span></code> script to do so can be downloaded <a class="reference download internal" download="" href="../_downloads/413ee71f781407eaac54a462330a3b01/download-combined.R"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./c08-combining"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="1-background.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8.1. </span>Introduction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3-data-wrangling.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8.3. </span>Data Wrangling</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Natalie Zelenka<br/>
  
      &copy; Copyright 2020.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>